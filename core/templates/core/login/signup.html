{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sign Up | V planner</title>
  <!-- CHANGED: Using login.css for all styling -->
  <link rel="stylesheet" href="{% static 'css/login.css' %}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
</head>
<body>
  <!-- CHANGED: Using same glassmorphism layout as login page -->
  <div class="login-page" style="background-image: url('{% static 'images/background_login.png' %}');">
    <div class="login-overlay"></div>
    
    <div class="login-card" style="max-width: 450px;">
      <!-- CHANGED: Display Django messages (form errors, success messages) -->
      {% if messages %}
        <div style="margin-bottom: 16px;">
          {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
              {{ message }}
              <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
          {% endfor %}
        </div>
      {% endif %}

      <!-- Header Section -->
      <div class="login-header">
        <h1 class="login-title">Create Your Account</h1>
        <p class="login-subtitle">Join V planner and plan your dream wedding</p>
      </div>

      <!-- CHANGED: Customer registration form with fields from Customer model -->
      <form class="login-form" method="post" action="{% url 'landing_signup' %}" id="registration-form" novalidate>
        {% csrf_token %}
        
        <!-- CHANGED: Hidden role field - always set to 'customer' for signup page -->
        <input type="hidden" name="role" value="customer">
        
        <!-- Form Errors -->
        {% if form.non_field_errors %}
          <div class="alert alert-danger alert-dismissible fade show" role="alert" style="margin-bottom: 16px;">
            {% for error in form.non_field_errors %}
              <div>{{ error }}</div>
            {% endfor %}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
          </div>
        {% endif %}

        <!-- Email (User field - mandatory) -->
        <div class="form-group">
          <input type="email" name="email" id="id_email" class="form-control" placeholder="Email address" required>
          {% if form.email.errors %}
            <div class="text-danger small" style="margin-top: 4px;">
              {% for error in form.email.errors %}{{ error }}{% endfor %}
            </div>
          {% endif %}
        </div>

        <!-- Password (mandatory) -->
        <div class="form-group">
          <input type="password" name="password" id="id_password" class="form-control" placeholder="Password" required>
          {% if form.password.errors %}
            <div class="text-danger small" style="margin-top: 4px;">
              {% for error in form.password.errors %}{{ error }}{% endfor %}
            </div>
          {% endif %}
        </div>

        <!-- Wedding Day (Customer field - mandatory, must be future date) -->
        <div class="form-group">
          <input type="date" name="wedding_day" id="id_wedding_day" class="form-control" required min="">
          <small class="text-white-50" style="margin-top: 4px; display: block;">Wedding day (must be in the future)</small>
          {% if form.wedding_day.errors %}
            <div class="text-danger small" style="margin-top: 4px;">
              {% for error in form.wedding_day.errors %}{{ error }}{% endfor %}
            </div>
          {% endif %}
        </div>

        <!-- Bride Name (Customer field - optional) -->
        <div class="form-group">
          <input type="text" name="bride_name" id="id_bride_name" class="form-control" placeholder="Bride name (optional)">
        </div>

        <!-- Groom Name (Customer field - optional) -->
        <div class="form-group">
          <input type="text" name="groom_name" id="id_groom_name" class="form-control" placeholder="Groom name (optional)">
        </div>

        <!-- Bride Contact (Customer field - optional) -->
        <div class="form-group">
          <input type="text" name="bride_contact" id="id_bride_contact" class="form-control" placeholder="Bride phone (optional)">
        </div>

        <!-- Groom Contact (Customer field - optional) -->
        <div class="form-group">
          <input type="text" name="groom_contact" id="id_groom_contact" class="form-control" placeholder="Groom phone (optional)">
        </div>

        <!-- Submit Button -->
        <button type="submit" class="btn btn-login" style="margin-top: 16px; width: 100%; background-color: #79976e !important; color: #ffffff !important;">Create Account</button>
      </form>

      <!-- Login Link -->
      <div style="text-align: center; margin-top: 16px;">
        <a href="{% url 'users:login' %}" class="forgot-link">Already have an account? Log in</a>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- CHANGED: Set minimum date for wedding day to today -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Set the minimum date to today to prevent selecting past dates
      const weddingDayInput = document.getElementById('id_wedding_day');
      if (weddingDayInput) {
        const today = new Date().toISOString().split('T')[0];
        weddingDayInput.setAttribute('min', today);
      }
    });
  </script>
</body>
</html>